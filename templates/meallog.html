<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meal Logger</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .track-container {
        display: inline-block;
        padding: 15px;
        margin-top: 20px;
        width: 85%;
        background-color: #f2f4e2;
        border: 1px solid #ed8218;
        border-radius: 15px;
        text-align: justify;
        font-size: 20px;
        color: black;
        margin-right: 20px;
        font-family: Georgia, "Times New Roman", Times, serif;
        line-height: 2;
      }
      .nav-links {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-grow: 1;
        text-decoration: none;
      }
      .nav-links a {
        color: #whitesmoke;
        font-size: 20px;
        font-weight: bold;
        margin-right: 60px;
        margin-left: 60px;
        text-decoration: none;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        text-decoration: none;
      }
      body {
        margin: 0;
        padding: 0;
        background-color: #fffbf0;
      }
      .navbar {
        background: #53655c;
        padding: 10px 15px;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .navbar .logo img {
        height: 50px;
        margin-right: 10px;
      }
      .intro-section {
        padding: 20px;
        text-align: center;
        width: 85%;
        margin: 0 auto;
      }
      .planner-section {
        padding: 20px;
        width: 85%;
        margin: 0 auto;
      }
      .planner-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .planner-header h2 {
        margin: 0;
      }
      .divider {
        border: none;
        border-top: 2px solid #333333;
        margin: 10px 0;
      }
      .float-right {
        float: right;
      }
      .card-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
      }
      .card {
        width: 18rem;
        background-color: #f2f4e2; /* White background for cards */
        border: 1px solid #dedede; /* Light gray border */
        border-radius: 10px; /* Rounded corners */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
      }
      .card-body {
        padding: 15px;
        color: #333333; /* Dark gray text color */
      }
      .modal-dialog {
        max-width: 500px;
      }
      .modal-content {
        padding: 20px;
        border-radius: 10px; /* Rounded corners for modal */
        background-color: #f2f4e2; /* White background */
      }
      .modal-body {
        padding: 20px;
      }
      .modal-header {
        border-bottom: 1px solid #e5e5e5;
      }
      .modal-title {
        color: #333333; /* Dark gray text color */
      }
      .filler-text {
        text-align: center;
        margin: 40px 0;
        font-size: 18px;
        color: #53655c;
      }
      .btn-primary {
        background-color: #ed8218 !important; /* Orange color */
        color: #ffffff !important; /* White text color */
        border: none !important; /* Remove default border */
        padding: 10px 20px !important; /* Adjust padding as needed */
        font-size: 16px !important; /* Adjust font size as needed */
        border-radius: 15px !important; /* Rounded corners */
        cursor: pointer !important; /* Pointer cursor on hover */
        transition: none !important; /* Remove transition effects */
        outline: none !important; /* Remove default focus outline */
        box-shadow: none !important; /* Remove any box shadow */
      }

      .btn-primary:hover,
      .btn-primary:focus,
      .btn-primary:active {
        background-color: #ed8218 !important; /* Keep the color consistent */
        color: #ffffff !important; /* Keep text color consistent */
        border: none !important; /* Keep border style consistent */
        box-shadow: none !important; /* Remove any focus or hover shadow */
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <div class="logo">
        <a href="#">
          <img src="/static/image.png" alt="LOGO" />
          EATO MATE
        </a>
      </div>
      <div class="nav-links">
        <a href="/" style="color: whitesmoke">HOME</a>
        <a href="/tracker" style="color: whitesmoke">MEAL LOG</a>
        <a href="/shop" style="color: whitesmoke">MON SHOP</a>
        <a href="#" style="color: whitesmoke">{{ points }}</a>
      </div>
    </nav>

    <div class="intro-section">
      <h1 style="margin-top: 30px; margin-bottom: 30px">
        Welcome to Your Meal Logger
      </h1>
      <div class="track-container">
        <p>
          Track your meals and transform your eating habits with ease. As they
          say, "Every meal counts!" Here, you can: <br />1. Track your meals
          <br />2. Reflect on your eating patterns<br />
          3. Stay on top of your nutrition goals<br />
          With each entry, you get one step closer to a healthier you!<br />
          Feeling a bit lost? Don’t worry! Logging your meals earns you Nurture
          Stars. Use these stars to redeem cool rewards and stay motivated.
          Ready to get started? Let’s dive in and make every meal matter!
        </p>
      </div>
    </div>

    <div class="planner-section">
      <div class="planner-header">
        <h2 style="margin-top: 30px; margin-bottom: 30px">Planner</h2>
        <button
          class="btn btn-primary"
          data-toggle="modal"
          data-target="#mealModal"
        >
          Add New Log
        </button>
      </div>
      <hr class="divider" />
      <div class="filler-text">Start by adding a meal</div>
      <div class="card-container mt-4" id="mealLogs">
        <!-- Meal logs will be displayed here -->
      </div>
    </div>

    <div
      class="modal fade"
      id="mealModal"
      tabindex="-1"
      aria-labelledby="mealModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="mealModalLabel">New Meal Log</h5>
            <button
              type="button"
              class="btn-close"
              data-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="mealForm">
              <div class="form-group">
                <label for="mealType">Meal Type</label>
                <select class="form-control" id="mealType" required>
                  <option>Breakfast</option>
                  <option>Morning Snack</option>
                  <option>Lunch</option>
                  <option>Afternoon Snack</option>
                  <option>Dinner</option>
                  <option>Evening Snack</option>
                  <option>Late Night Snack</option>
                  <option>Unplanned Snack</option>
                </select>
              </div>
              <div class="form-group">
                <label for="feeling">Feeling</label>
                <select class="form-control" id="feeling" required>
                  <option>Anxious</option>
                  <option>Stressed</option>
                  <option>Calm</option>
                  <option>Guilty</option>
                  <option>Happy</option>
                  <option>Sad</option>
                  <option>Angry</option>
                  <option>Excited</option>
                  <option>Content</option>
                  <option>Disappointed</option>
                  <option>Nervous</option>
                  <option>Relaxed</option>
                  <option>Frustrated</option>
                  <option>Confident</option>
                  <option>Lonely</option>
                  <option>Motivated</option>
                </select>
              </div>
              <div class="form-group">
                <label>Did you overeat?</label><br />
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="overeat"
                    id="overeatYes"
                    value="Yes"
                    required
                  />
                  <label class="form-check-label" for="overeatYes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="overeat"
                    id="overeatNo"
                    value="No"
                    required
                  />
                  <label class="form-check-label" for="overeatNo">No</label>
                </div>
              </div>
              <div class="form-group">
                <label>Did you undereat?</label><br />
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="undereat"
                    id="undereatYes"
                    value="Yes"
                    required
                  />
                  <label class="form-check-label" for="undereatYes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="undereat"
                    id="undereatNo"
                    value="No"
                    required
                  />
                  <label class="form-check-label" for="undereatNo">No</label>
                </div>
              </div>
              <div class="form-group">
                <label>Did you binge?</label><br />
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="binge"
                    id="bingeYes"
                    value="Yes"
                    required
                  />
                  <label class="form-check-label" for="bingeYes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="binge"
                    id="bingeNo"
                    value="No"
                    required
                  />
                  <label class="form-check-label" for="bingeNo">No</label>
                </div>
              </div>
              <div class="form-group">
                <label>Urge to restrict?</label><br />
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="restrict"
                    id="restrictYes"
                    value="Yes"
                    required
                  />
                  <label class="form-check-label" for="restrictYes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="restrict"
                    id="restrictNo"
                    value="No"
                    required
                  />
                  <label class="form-check-label" for="restrictNo">No</label>
                </div>
              </div>
              <div class="form-group">
                <label for="eatWith">Whom did you eat with?</label>
                <select class="form-control" id="eatWith" required>
                  <option>Alone</option>
                  <option>Family</option>
                  <option>Friends</option>
                  <option>Peers</option>
                  <option>Outdoors</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary">Save Log</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
      document
        .getElementById("mealForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const mealType = document.getElementById("mealType").value;
          const feeling = document.getElementById("feeling").value;
          const overeat = document.querySelector(
            'input[name="overeat"]:checked'
          ).value;
          const undereat = document.querySelector(
            'input[name="undereat"]:checked'
          ).value;
          const binge = document.querySelector(
            'input[name="binge"]:checked'
          ).value;
          const restrict = document.querySelector(
            'input[name="restrict"]:checked'
          ).value;
          const eatWith = document.getElementById("eatWith").value;

          const mealLog = {
            meal_type: mealType,
            feeling: feeling,
            overeating: overeat,
            undereating: undereat,
            urge_to_binge: binge,
            urge_to_restrict: restrict,
            eat_with: eatWith,
          };

          // Send the meal log to the backend
          fetch("/add_meal_log", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(mealLog),
          })
            .then((response) => response.json())
            .then((data) => {
              addMealLogToPlanner(data);
              $("#mealModal").modal("hide");
              document.getElementById("mealForm").reset();
            })
            .catch((error) => console.error("Error:", error));
        });

      function addMealLogToPlanner(log) {
        const logCard = `
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">${log.meal_type}</h5>
                <p class="card-text">Feeling: ${log.feeling}</p>
                <p class="card-text">Overeat: ${log.overeating}</p>
                <p class="card-text">Undereat: ${log.undereating}</p>
                <p class="card-text">Urge to binge: ${log.urge_to_binge}</p>
                <p class="card-text">Urge to restrict: ${log.urge_to_restrict}</p>
                <p class="card-text">Ate with: ${log.eat_with}</p>
              </div>
            </div>
          `;
        document.getElementById("mealLogs").innerHTML += logCard;
      }

      // Fetch meal logs when the page loads
      document.addEventListener("DOMContentLoaded", function () {
        fetch("/get_meal_logs")
          .then((response) => response.json())
          .then((data) => {
            data.forEach((log) => addMealLogToPlanner(log));
          })
          .catch((error) => console.error("Error:", error));
      });
    </script>
  </body>
</html>
